RewriteEngine On

#http to https
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

#shtml
AddType text/html .html
AddHandler server-parsed .html

#html
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^\.]+)$ $1.html [NC,L]

#index redirect
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /index\.html\ HTTP/ 
RewriteRule ^index\.html$ http://edith.codexeg.net/ [R=301,L]

#html to non html
RewriteCond %{THE_REQUEST} \.html
RewriteRule ^(.*)\.html$ /$1 [R=301,L]
AddDefaultCharset UTF-8
Options -Indexes

# Disable directory browsing
Options All -Indexes

#404 and 500 redirct
ErrorDocument 404 https://edith.codexeg.net/
ErrorDocument 500 https://www.codexeg.net/

# Disable browsers from being able to validate files, to improve speed
Header unset ETag
FileETag None

# disallows direct access to the htaccess file
<Files .htaccess>
    Order Allow,Deny
    Deny from all
</Files>

# allows direct access to the XML files
<Files ~ "\.xml$">
    Order allow,deny
    Allow from all
    Satisfy All
</Files>

# Set web server headers
Header set X-Frame-Options: DENY
Header set X-Content-Type-Options: nosniff
Header set Referrer-Policy-Options: no-referrer
Header set Access-Control-Allow-Origin "*"
Header set Access-Control-Allow-Headers: "*"

RewriteCond %{HTTP_REFERER} !^http://edith.codexeg.net/.*$      [NC]
RewriteCond %{HTTP_REFERER} !^http://edith.codexeg.net$      [NC]
RewriteCond %{HTTP_REFERER} !^http://www.edith.codexeg.net/.*$      [NC]
RewriteCond %{HTTP_REFERER} !^http://www.edith.codexeg.net$      [NC]
RewriteCond %{HTTP_REFERER} !^https://edith.codexeg.net/.*$      [NC]
RewriteCond %{HTTP_REFERER} !^https://edith.codexeg.net$      [NC]
RewriteCond %{HTTP_REFERER} !^https://www.edith.codexeg.net/.*$      [NC]
RewriteCond %{HTTP_REFERER} !^https://www.edith.codexeg.net$      [NC]
RewriteRule .*\.(jpg|jpeg|gif|png|bmp)$ https://edith.codexeg.net [R,NC]
